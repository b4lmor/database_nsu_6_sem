# Курсовой проект по дисциплине "Базы данных"

## Тема: Информационная система торговой организации

- [**ТЗ от заказчика**](report/TASK.md)

### Отчёт

#### Задание #1 "КОНЦЕПТУАЛЬНОЕ (ИНФОЛОГИЧЕСКОЕ) ПРОЕКТИРОВАНИЕ БАЗЫ ДАННЫХ"

- [**Условие**](report/task_1/TODO.md)
- [**Отчёт**](report/task_1/REPORT.md)

#### Задание #2 "ПОЛЬЗОВАТЕЛИ И РОЛИ"

- [**Условие**](report/task_2/TODO.md)
- [**Отчёт**](report/task_2/REPORT.md)

#### Задание #3 "ЛОГИЧЕСКОЕ ПРОЕКТИРОВАНИЕ БАЗЫ ДАННЫХ, ХРАНИМЫЕ ПРОЦЕДУРЫ И ТРИГГЕРЫ"

- [**Условие**](report/task_3/TODO.md)
- [**Отчёт**](report/task_3/REPORT.md)

#### Задание #4 "ПЕРЕНОС ЛОГИЧЕСКОГО КОНЦЕПТА В ФИЗИЧЕСКИЙ"

- [**Отчёт**](report/task_4/REPORT.md)

#### Задание #5 "РАЗРАБОТКА SQL-ЗАПРОСОВ"

- [**Отчёт**](report/task_5/REPORT.md)

#### Задание #6 "РЕАЛИЗАЦИЯ ПРОЕКТА ДЛЯ РАБОТЫ С ФИЗИЧЕСКОЙ БАЗОЙ ДАННЫХ"

- [**Отчёт**](report/task_6/REPORT.md)

#### Задание #7 "ПРОДВИНУТОЕ ВЗАИМОДЕЙСТВИЕ С БАЗОЙ ДАННЫХ. КОНКУРЕНТНЫЙ ДОСТУП"

- [**Отчёт**](report/task_7/REPORT.md)

## Структура проекта

### Модуль database

#### Структура модуля:
- __scripts__ - директория со скриптами
    - __migrations__ - директория с миграциями (скрипты создания таблиц и т.д.)
    - __create_roles.sql__ - SQL файл для инициализации ролей 
- __docker-compose.yml__ - docker-compose файл для поднятия postgres контейнера в docker
- __build.gradle__ - файл, описывающий применение миграций через gradle (flyway)

### Модуль service

#### Структура модуля:
- __src__ - директория с исходным кодом приложения
- __build.gradle__ - файл, описывающий сборку приложения (загрузку зависимостей и т.д.)

##### Запустить приложение

1. Запустить БД (см. [docker-compose файл](database/docker-compose.yml))

2. Чтобы инициализировать роли при первом запуске БД, нужно выполнить скрипт из [SQL файла](database/scripts/create_roles.sql)

3. Запустить приложение `./gradlew :service:runApp`

### Миграции

- Процесс миграции запускается **супер-пользователем**
- Это происходит **ДО** запуска приложения
- Для старта миграций нужно ввести **url**, **username** и **password** в [Конфигурационном файле](./database/build.gradle)

##### Запустить процесс миграции: `./gradlew flywayMigrate`

##### Отменить миграции: `./gradlew flywayClean`

##### Отменить + запустить миграции: `./gradlew flywayCleanAndMigrate`
