# Курсовой проект по дисциплине "Базы данных"

## Тема: Информационная система торговой организации

- [**ТЗ от заказчика**](report/TASK.md)

### Отчёт

#### Задание #1 "КОНЦЕПТУАЛЬНОЕ (ИНФОЛОГИЧЕСКОЕ) ПРОЕКТИРОВАНИЕ БАЗЫ ДАННЫХ"

- [**Условие**](report/task_1/TODO.md)
- [**Отчёт**](report/task_1/REPORT.md)

#### Задание #2 "ПОЛЬЗОВАТЕЛИ И РОЛИ"

- [**Условие**](report/task_2/TODO.md)
- [**Отчёт**](report/task_2/REPORT.md)

#### Задание #3 "ЛОГИЧЕСКОЕ ПРОЕКТИРОВАНИЕ БАЗЫ ДАННЫХ, ХРАНИМЫЕ ПРОЦЕДУРЫ И ТРИГГЕРЫ"

- [**Условие**](report/task_3/TODO.md)
- [**Отчёт**](report/task_3/REPORT.md)

#### Задание #4 "РЕАЛИЗАЦИЯ ПРОЕКТА"

- см. `./service/`

#### Задание #5 "РАЗРАБОТКА SQL-ЗАПРОСОВ"

- [**Отчёт**](report/task_5/REPORT.md)

## Структура проекта

### Модуль database

#### Структура модуля:
- __assets__ - директория с диаграммой
- __scripts__ - директория со скриптами
    - __migrations__ - директория с миграциями (скрипты создания таблиц и т.д.)
    - __insertions__ - директория со скриптами для вставки данных
- __docker-compose.yml__ - докер-компоус файл для поднятия postgres
- __build.gradle__ - файл, описывающий применение миграций через gradle

##### Запустить приложение

1. Запустить БД (см. [Докер-компоус файл](database/docker-compose.yml))

2. Чтобы инициализировать роли при первом запуске БД, нужно выполнить [SQL файл](database/scripts/create_roles.sql)

3. Запустить приложение `./gradlew :service:runApp`

### Миграции

- Процесс миграции запускается **супер-пользователем**
- Это происходит **ДО** запуска приложения
- Для старта миграций нужно ввести **url**, **username** и **password** в [Конфигурационном файле](./database/build.gradle)

##### Запустить процесс миграции: `./gradlew flywayMigrate`

##### Отменить миграции: `./gradlew flywayClean`

##### Отменить + Запустить миграции: `./gradlew flywayCleanAndMigrate`
